<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="./src/output.css" rel="stylesheet" />
    <title>Admin Login</title>
</head>
<body class="bg-gradient-to-tr from-purple-700 via-indigo-700 to-blue-600 min-h-screen flex items-center justify-center">
    <div class="bg-black bg-opacity-60 backdrop-blur-md rounded-xl shadow-lg p-8 w-full max-w-md text-white">
        <h1 class="text-3xl font-bold text-center mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6mb-6">Admin Login</h1>
        <form id="loginForm" class="space-y-4" novalidate>
            <div>
                <label for="empid" class="block mb-1 font-semibold">Employee ID:</label>
                <input
                    type="text"
                    id="empid"
                    name="empid"
                    required
                    placeholder="Enter Employee ID"
                    class="w-full rounded-md px-3 py-2  focus:outline-none focus:ring-2 focus:ring-indigo-400"
                />
                <p class="text-red-500 mt-1 text-sm min-h-[1rem]" id="empidError"></p>
            </div>
            <div>
                <label for="dob" class="block mb-1 font-semibold">DOB:</label>
                <input
                    type="date"
                    id="dob"
                    name="dob"
                    required
                    class="w-full rounded-md px-3 py-2  focus:outline-none focus:ring-2 focus:ring-indigo-400"
                />
                <p class="text-red-500 mt-1 text-sm min-h-[1rem]" id="dobError"></p>
            </div>
            <div>
                <label for="password" class="block mb-1 font-semibold">Password:</label>
                <input
                    type="password"
                    id="password"
                    name="password"
                    required
                    placeholder="Enter Password"
                    class="w-full rounded-md px-3 py-2  focus:outline-none focus:ring-2 focus:ring-indigo-400"
                />
                <p class="text-red-500 mt-1 text-sm min-h-[1rem]" id="passwordError"></p>
            </div>
            <div>
                <label for="captcha" class="block mb-1 font-semibold">CAPTCHA:</label>
                <div class="flex items-center space-x-2 mb-2">
                    <div
                        id="captchaDisplay"
                        class="bg-blue-700 px-4 py-2 rounded-md font-semibold text-lg text-white select-none"
                    ></div>
                    <button
                        type="button"
                        id="refreshCaptcha"
                        class="text-blue-300 hover:text-blue-100 transition-transform duration-300 transform hover:rotate-90 focus:outline-none"
                        aria-label="Refresh CAPTCHA"
                    >
                        &orarr;
                    </button>
                </div>
                <input
                    type="text"
                    id="captcha"
                    name="captcha"
                    required
                    placeholder="Enter CAPTCHA result"
                    class="w-full rounded-md px-3 py-2  focus:outline-none focus:ring-2 focus:ring-indigo-400"
                />
                <p class="text-red-500 mt-1 text-sm min-h-[1rem]" id="captchaError"></p>
            </div>
            <button
                type="submit"
                class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 focus:ring-4 focus:ring-indigo-300 rounded-md font-bold transition-colors"
            >
                Log In
            </button>
        </form>
    </div>

    <script>
        (function () {
            const loginForm = document.getElementById("loginForm");
            const empidInput = document.getElementById("empid");
            const dobInput = document.getElementById("dob");
            const passwordInput = document.getElementById("password");
            const captchaDisplay = document.getElementById("captchaDisplay");
            const captchaInput = document.getElementById("captcha");
            const refreshCaptchaBtn = document.getElementById("refreshCaptcha");

            const empidError = document.getElementById("empidError");
            const dobError = document.getElementById("dobError");
            const passwordError = document.getElementById("passwordError");
            const captchaError = document.getElementById("captchaError");

            let currentCaptchaAnswer = null;

            // Set max date for DOB to today
            const maxDateString = new Date().toISOString().split("T")[0];
            dobInput.setAttribute("max", maxDateString);

            function generateCaptcha() {
                const num1 = Math.floor(Math.random() * 20) + 1;
                const num2 = Math.floor(Math.random() * 20) + 1;
                const operator = Math.random() < 0.5 ? "+" : "-";

                let question, answer;
                if (operator === "+") {
                    question = `${num1} + ${num2}`;
                    answer = num1 + num2;
                } else {
                    if (num2 > num1) {
                        question = `${num2} - ${num1}`;
                        answer = num2 - num1;
                    } else {
                        question = `${num1} - ${num2}`;
                        answer = num1 - num2;
                    }
                }
                captchaDisplay.textContent = question;
                currentCaptchaAnswer = answer;
                captchaInput.value = "";
                captchaError.textContent = "";
            }

            function validateForm() {
                let valid = true;
                empidError.textContent = "";
                dobError.textContent = "";
                passwordError.textContent = "";
                captchaError.textContent = "";

                if (!empidInput.value.trim()) {
                    empidError.textContent = "Employee ID is required.";
                    valid = false;
                }

                if (!dobInput.value) {
                    dobError.textContent = "Date of Birth is required.";
                    valid = false;
                } else {
                    const dobDate = new Date(dobInput.value);
                    const now = new Date();
                    if (dobDate > now) {
                        dobError.textContent = "Date of Birth cannot be in the future.";
                        valid = false;
                    }
                }

                if (!passwordInput.value.trim()) {
                    passwordError.textContent = "Password is required.";
                    valid = false;
                }

                if (!captchaInput.value.trim()) {
                    captchaError.textContent = "CAPTCHA answer is required.";
                    valid = false;
                } else if (parseInt(captchaInput.value, 10) !== currentCaptchaAnswer) {
                    captchaError.textContent = "CAPTCHA answer is incorrect.";
                    valid = false;
                }

                return valid;
            }

            loginForm.addEventListener("submit", function (e) {
                e.preventDefault();
                if (validateForm()) {
                    alert("Admin login successful!");
                    loginForm.reset();
                    generateCaptcha();
                }
            });

            refreshCaptchaBtn.addEventListener("click", function () {
                generateCaptcha();
            });

            // Generate captcha initially
            generateCaptcha();
        })();
    </script>
</body>
</html>

